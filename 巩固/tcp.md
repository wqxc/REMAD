三次握手连接
（1）序号：Seq序号，占32位，用来标识从TCP源端向目的端发送的字节流，发起方发送数据时对此进行标记。简单的理解就是一个标记，是一个0-2的三十二次方减一之间的数字。

（2）确认序号：Ack序号，占32位，只有ACK标志位为1时，确认序号字段才有效，Ack=Seq+1。

  标志位：共6个，即URG、ACK、PSH、RST、SYN、FIN等，具体含义如下：
  （A）URG：紧急指针（urgent pointer）有效。
  （B）ACK：确认序号有效。
  （C）PSH：接收方应该尽快将这个报文交给应用层。
  （D）RST：重置连接。
  （E）SYN：发起一个新连接。
  （F）FIN：释放一个连接。


连接的套路是。
发起连接的一方。我们默认是浏览器。
浏览器先发送一个syn=1；Seq=随机数,比如是j。给服务端。
  解释一下：syn=1；表示要与服务器建立连接，Seq标识的是发送信息的序号，相当于标志此次连接的一个值。其中浏览器发送给服务器一个seq=j则是期望，服务器
  在接收到的时候返回给自己一个seq=j+1的值。
服务器接受到浏览器发送的请求后。返回给浏览器：syn=1;ACK=1；ack=j+1;seq=k
  解释一下：syn=1是表示我服务器愿意跟你浏览器建立联系，ACK表示我已经接收到你发送的Seq序号了，而且我确认他有效，
  ack=j+1表示，我给你一个你需要的值j+1。seq=k，则是服务器发送的标记，同样希望浏览器接收到之后发给自己一个k+1的序号值。

浏览器接收到了服务器发送的信息会再次返回给服务器一些值：ACK=1；ack=k+1;而后双方就建立连接了。
  ACK=1表示我确认了，ack=k+1，表示我给你你想要的值。

ACK与ack是不一样的：ACK表示的是确认序号有效，ack则表示的是给对方想要的序号。

简单的总结一下：
  浏览器为A，服务器为B
  A要与B建立tcp连接。
  A 说我要与你建立连接syn=1，这是我给你发的标记seq=j;你要是收到了就返回给我一个j+1；让我知道，我发信息的能力是没问题的。
  B收到了A发来的信息，说：我同意与你建立连接syn=1，你发的序号是可用的(ACK=1),而且你发送信息的能力是没问题的，我已经收到了，给你你想要的值(ack=j+1);
    但是，我不知道我发送信息的能力是不是好的，我给你一个序号seq=k，你要给我一个k+1的值。
  A收到了B返回的信息，知道自己发的信息能力是你没问题的，接收信息的能力也是没问题的，于是发一个ACK=1，表示B发送的标记能用。而后发送一个ack=k+1,
  到了这个时候，服务器知道自己发送能力与接收能力都没有问题，浏览器也知道了而且，两方已经建立联系了。如此三次握手就完成了。





四次挥手
1、客户端发起、请求断开链接。发送报文FIN=1，当FIN=1的时候，表明此报文的发送方已经完成了数据的发送，没有新

的数据要传送，并要求释放链接。客户端进入FIN-WAIT-1（终止等待1）状态。
  此时浏览器发送FIN=1；seq=j；FIN表示我要已经没有什么要发送的了，断开连接吧。

2、服务器收到客户端的请求断开链接的报文之后，返回确认信息。ACK=1，服务器进入CLOSE-WAIT（关闭等待）状

态。此时客户端不能给服务器发送信息报文，只能接收。客户端收到来自服务器端的确认后，进入FIN-WAIT-2（终止等

待2）状态，等待服务器发出链接释放报文段。
  服务器发送信息给客户端：ACK=1；ack=j+1；seq=m。


3、当服务器也没有了可以传的信息之后，给客户端发送请求结束的报文。FIN=1，ACK=1，服务器进入LAST-ACK（最

终确认）状态。
  服务器发送信息给客户端：FIN=1；ACK=1；ack=j+1；seq=w

4、客户端接收到FIN=1的报文之后，返回确认报文，ACK=1，发送完毕之后，客户端进入TIME-WAIT（时间等待）状

态，等待两个时间周期。链接关闭。服务器端收到客户端发出的确认就进入CLOSED（关闭）状态。
  客户端发送信息给客户端：ACK=1；ack=w+1；seq=m+1


最后之所以要等待两个时间周期的原因在于：

1、为了保证客户端发送的最后一个ACK报文段能够到达服务器。因为这个ACK有可能丢失，从而导致处在LAST-ACK状

态的服务器收不到对FIN-ACK的确认报文。服务器会超时重传这个FIN-ACK，接着客户端再重传一次确认，重新启动时间

等待计时器。最后客户端和服务器都能正常的关闭。假设客户端不等待2MSL，而是在发送完ACK之后直接释放关闭，一

但这个ACK丢失的话，服务器就无法正常的进入关闭连接状态。

2、还可以防止已失效的报文段。客户端在发送最后一个ACK之后，再经过经过2MSL，就可以使本链接持续时间内所产

生的所有报文段都从网络中消失。从保证在关闭连接后不会有还在网络中滞留的报文段去骚扰服务器。

注意：在服务器发送了FIN-ACK之后，会立即启动超时重传计时器。客户端在发送最后一个ACK之后会立即启动时间等

待计时器。
